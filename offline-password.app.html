<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Password Thing</title>
	<style>
		html {
			background: black;
			color: white;
		}

		html,
		body {
			/* height: 100%; */
			width: 100%;
			font-family: 'Fira Code', 'Hack', 'Courier New', Courier, monospace
		}

		.container {
			max-width: 950px;
			margin: auto;

			display: flex;
			flex-flow: column;
			justify-content: center;
			align-items: stretch;
		}
	</style>
</head>

<body class="container">
	<main>
		<h1>Offline Password Thing</h1>

		<h2>Password</h2>
		<label for="input">Password</label>
		<input value="" autocomplete="off" type="text" id="input">
		<table>
			<tbody>
				<tr>
					<td style="min-width: 2em;"><code data-id="length"></code></td>
					<td>Length</td>
				</tr>
				<tr>
					<td><code data-id="lowerCase"></code></td>
					<td>Lower Case</td>
				</tr>
				<tr>
					<td><code data-id="upperCase"></code></td>
					<td>Upper Case</td>
				</tr>
				<tr>
					<td><code data-id="numbers"></code></td>
					<td>Numbers</td>
				</tr>
				<tr>
					<td><code data-id="symbols"></code></td>
					<td>Symbols</td>
				</tr>
				<tr>
					<td><code data-id="spaces"></code></td>
					<td>Spaces</td>
				</tr>
			</tbody>
		</table>
	</main>
</body>

<script>
	const input = document.getElementById("input")
	const {
		length,
		upperCase,
		lowerCase,
		symbols,
		spaces,
		numbers
	} = idsToMap();

	input.addEventListener("input", () => {
		const s = input.value;
		update(length, s.length);

		update(upperCase,
			matchLength(s, /[A-Z]/g));

		update(lowerCase,
			matchLength(s, /[a-z]/g));

		update(numbers,
			matchLength(s, /\d/g));

		update(symbols,
			matchLength(s, /[!-/]|[:-@]|[\[-`]|[{-}]|~/g));

		update(spaces,
			matchLength(s, / /g));
	})

	function matchLength(string, regex) {
		return (string.match(regex) || []).length
	}

	/** @returns {Object.<string, HTMLElement>} */
	function idsToMap() {
		return [...document.querySelectorAll("[data-id]")]
			.reduce((running, next) => {
				if (next.dataset.id in running) {
					running[next.dataset.id].push(next)
				} else {
					running[next.dataset.id] = [next]
				}
				return running;
			}, Object.create(null));
	}

	/**
	 * @param elementList {HTMLElement[]}
	 * @param textContent {string | null}
	 */
	function update(elementList, textContent) {
		elementList.forEach(v => v.textContent = textContent)
	}
</script>

</html>
